### 2.4 Simple Queries

**Retrieve Data through ID**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT * FROM tracks WHERE track_id="7BRCa8MPiyuvr2VU3O9W0F"')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q11 = average_time
```

    Average response time 0.010 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'_id':'7BRCa8MPiyuvr2VU3O9W0F'}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q11 = average_time
```

    Average response time 0.025 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'_id':'7BRCa8MPiyuvr2VU3O9W0F'}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q11 = average_time
```

    Average response time 0.090 seconds
    


```python

```

**Retrieve data based on specific genre**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT * FROM tracks WHERE genre="hardcore" ')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q12 = average_time
```

    Average response time 0.408 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'genre':'hardcore'}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q12 = average_time
```

    Average response time 0.043 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'genre':'hardcore'}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q12 = average_time
```

    Average response time 0.445 seconds
    


```python

```

**Retrieve Data based on specific Year**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT * FROM tracks WHERE release_year=2015 ')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q13 = average_time
```

    Average response time 0.631 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'release_year':2015}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q13 = average_time

```

    Average response time 0.154 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'release_year':2015}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q13 = average_time
```

    Average response time 1.113 seconds
    


```python

```

**Retrieve Data based on specific year and genre**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT * FROM tracks WHERE release_year=2015 AND genre="hip-hop"')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q14 = average_time
```

    Average response time 0.022 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'release_year': 2015,'genre':'hip-hop'}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q14 = average_time
```

    Average response time 0.015 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'release_year': 2015,'genre':'hip-hop'}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q14 = average_time
```

    Average response time 0.183 seconds
    

When SQL need joins

**Retrieve Data for specific Artist**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()

    MyCursor.execute('SELECT * FROM tracks t JOIN artists a ON t.artist_id=a.artist_id WHERE artist_name="pitbull"')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q15 = average_time
```

    Average response time 0.012 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'artist_name':'pitbull'}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q15 = average_time
```

    Average response time 0.000 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'artist_name':'pitbull'}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q15 = average_time
```

    Average response time 0.066 seconds
    


```python

```

**Retrieve Data for specific Artists**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()

    MyCursor.execute('SELECT * FROM tracks t JOIN artists a ON t.artist_id=a.artist_id WHERE artist_name IN ("pitbull","skrillex","David Guetta")')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds" )
MySQL_Q16 = average_time
```

    Average response time 0.015 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'artist_name': {'$in': ['Pitbull', 'Skrillex', 'David Guetta']}},{'track_name': 1, '_id': 0}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q16 = average_time
```

    Average response time 0.002 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'artist_name': {'$in': ['Pitbull', 'Skrillex', 'David Guetta']}},{'track_name': 1, '_id': 0}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q16 = average_time
```

    Average response time 0.134 seconds
    




**Retrieve Tracks  for specific Artists**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()

    MyCursor.execute('SELECT track_name FROM tracks t JOIN artists a ON t.artist_id=a.artist_id WHERE artist_name IN ("pitbull","skrillex","David Guetta")')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds" )
MySQL_Q17 = average_time
```

    Average response time 0.013 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()

    MongoDB_songs = list(songs_collection.find({'artist_name': {'$in': ['Pitbull', 'Skrillex', 'David Guetta']}},{'track_name': 1, '_id': 0}))
    for x in MongoDB_songs:
        pass

    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds" )
LocalMongoDB_Q17 = average_time
```

    Average response time 0.002 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'artist_name': {'$in': ['Pitbull', 'Skrillex', 'David Guetta']}},{'track_name': 1, '_id': 0}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q17 = average_time
```

    Average response time 0.135 seconds
    




**Find track and artist based on specific features**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()

    MyCursor.execute('SELECT t.track_name,a.artist_name FROM tracks t JOIN artists a ON t.artist_id=a.artist_id JOIN track_features tf ON t.track_id=tf.track_id WHERE t.popularity=37 AND ROUND(tf.danceability,3)=0.667 AND t.genre="acoustic"')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds" )
MySQL_Q18 = average_time
```

    Average response time 0.013 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()

    MongoDB_songs = list(songs_collection.find({'popularity':37,'genre':'acoustic','metrics.danceability':{'$gt':0.666,'$lt':0.669}},{'_id': 0,'track_name':1,'artist_name':1}))
    for x in MongoDB_songs:
        pass

    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds" )
LocalMongoDB_Q18 = average_time
```

    Average response time 0.016 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'popularity':37,'genre':'acoustic','metrics.danceability':{'$gt':0.666,'$lt':0.669}},{'_id': 0,'track_name':1,'artist_name':1}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q18 = average_time
```

    Average response time 0.093 seconds
