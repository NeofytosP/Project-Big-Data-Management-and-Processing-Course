### 2.5 Filter Queries

**Filter track names based on year and popularity**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT track_name FROM tracks WHERE release_year >2010 AND popularity>70')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q21 = average_time
```

    Average response time 0.017 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'release_year': {'$gt': 2010},'popularity': {'$gt': 70}},{'track_name': 1, '_id': 0}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q21 = average_time
```

    Average response time 0.006 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'release_year': {'$gt': 2010},'popularity': {'$gt': 70}},{'track_name': 1, '_id': 0}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q21 = average_time
```

    Average response time 0.153 seconds
    



**Filter tracks based on year and popularity**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT * FROM tracks t JOIN track_features tf ON t.track_id=tf.track_id WHERE t.release_year >2010 AND t.popularity>70')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q22 = average_time
```

    Average response time 0.050 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'release_year': {'$gt': 2010},'popularity': {'$gt': 70}}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q22 = average_time
```

    Average response time 0.009 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'release_year': {'$gt': 2010},'popularity': {'$gt': 70}}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q22 = average_time
```

    Average response time 0.184 seconds
    




**Filter tracks based on year,genre and popularity**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT * FROM tracks t JOIN track_features tf ON t.track_id=tf.track_id WHERE t.release_year =2010 AND t.genre="EDM" AND t.popularity>50')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q23 = average_time
```

    Average response time 0.018 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'release_year': {'$gt': 2010},'popularity': {'$gt': 50}},{'genre': 'EDM'}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q23 = average_time
```

    Average response time 0.082 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'release_year': {'$gt': 2010},'popularity': {'$gt': 50}},{'genre': 'EDM'}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q23 = average_time
```

    Average response time 0.375 seconds
    




**Select tracks with specifics genres and filter popularity**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT track_name FROM tracks WHERE (genre="hip-hop" AND popularity>70) OR (genre="electronic" AND popularity<50)')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q24 = average_time
```

    Average response time 0.513 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'$or':[{'genre': 'hip-hop','popularity':{'$gt':70}},{'genre': 'electronic','popularity':{'$lt':50}}]},{'_id':0,'track_name':1}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q24 = average_time
```

    Average response time 0.017 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'$or':[{'genre': 'hip-hop','popularity':{'$gt':70}},{'genre': 'electronic','popularity':{'$lt':50}}]},{'_id':0,'track_name':1}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q24 = average_time
```

    Average response time 0.190 seconds
    



**Filter track names based on genre and track features**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT track_name FROM tracks t JOIN track_features tf ON t.track_id=tf.track_id WHERE (t.genre="EDM" AND t.popularity>70 AND tf.instrumentalness>0.5 AND tf.tempo>110) OR (t.genre="TECHNO" AND t.popularity<70 AND tf.instrumentalness>0.5 AND tf.tempo>110)')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q25 = average_time
```

    Average response time 0.790 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'$or':[{'genre': 'EDM','popularity':{'$gt':70},'metrics.instrumentalness':{'$gt':0.5},'metrics.tempo':{'$gt':110}},{'genre': 'electronic','popularity':{'$lt':50},'metrics.instrumentalness':{'$gt':0.5},'metrics.tempo':{'$gt':110}}]},{'_id':0,'track_name':1}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q25 = average_time
```

    Average response time 0.012 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'$or':[{'genre': 'EDM','popularity':{'$gt':70},'metrics.instrumentalness':{'$gt':0.5},'metrics.tempo':{'$gt':110}},{'genre': 'electronic','popularity':{'$lt':50},'metrics.instrumentalness':{'$gt':0.5},'metrics.tempo':{'$gt':110}}]},{'_id':0,'track_name':1}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q25 = average_time
```

    Average response time 0.171 seconds
