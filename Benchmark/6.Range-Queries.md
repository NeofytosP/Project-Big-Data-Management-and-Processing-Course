### 2.6 Range Queries

**Tracks between 2015 and 2020**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT * FROM tracks t JOIN track_features tf ON t.track_id=tf.track_id WHERE t.release_year BETWEEN 2015 AND 2020')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q31 = average_time
```

    Average response time 2.385 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'release_year': {'$gte': 2015,'$lte': 2020}}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q31 = average_time
```

    Average response time 1.122 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'release_year': {'$gte': 2015,'$lte': 2020}}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q31 = average_time
```

    Average response time 6.583 seconds
    



**Tracks between 2015 and 2017 in specific genres**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT * FROM tracks t JOIN track_features tf ON t.track_id=tf.track_id WHERE t.release_year BETWEEN 2015 AND 2017 AND t.genre IN ("EDM","hardcore","dubstep","electro","electronic","trance","techno","house")')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q32 = average_time
```

    Average response time 1.935 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'release_year': {'$gte': 2015,'$lte': 2017},'genre': {'$in': ["EDM","hardcore","dubstep","electro","electronic","trance","techno","house"]}}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q32 = average_time
```

    Average response time 0.072 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'release_year': {'$gte': 2015,'$lte': 2017},'genre': {'$in': ["EDM","hardcore","dubstep","electro","electronic","trance","techno","house"]}}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q32 = average_time
```

    Average response time 0.377 seconds
    




**Artist names for specifc genre between 2020 and 2023**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT artist_name FROM artists a JOIN tracks t ON a.artist_id=t.artist_id WHERE t.genre = "rock" AND t.release_year BETWEEN 2020 AND 2023')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q33 = average_time
```

    Average response time 0.017 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'release_year': {'$gte': 2020,'$lte': 2023},'genre': 'rock'},{'_id': 0,'artist_name':1}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q33 = average_time
```

    Average response time 0.004 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'release_year': {'$gte': 2020,'$lte': 2023},'genre': 'rock'},{'_id': 0,'artist_name':1}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q33 = average_time
```

    Average response time 0.147 seconds
    




**Artist names with filtered features between 2020 and 2023**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT artist_name FROM artists a JOIN tracks t ON a.artist_id=t.artist_id JOIN track_features tf ON t.track_id=tf.track_id WHERE t.genre = "rock" AND t.release_year BETWEEN 2020 AND 2023 AND t.popularity>50 AND t.duration_ms<240000 AND tf.energy BETWEEN 0.20 AND 0.80 AND tf.valence > 0.6')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q34 = average_time
```

    Average response time 0.008 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.find({'genre':'rock','popularity': {'$gt':50 },'release_year': {'$gte':2020,'$lte':2023},'duration_ms':{'$lt':240000},'metrics.energy':{'$gte':0.20,'$lte':0.80},'metrics.valence':{'$gt':0.6}},{'_id':0,'artist_name':1}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q34 = average_time
```

    Average response time 0.004 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.find({'genre':'rock','popularity': {'$gt':50 },'release_year': {'$gte':2020,'$lte':2023},'duration_ms':{'$lt':240000},'metrics.energy':{'$gte':0.20,'$lte':0.80},'metrics.valence':{'$gt':0.6}},{'_id':0,'artist_name':1}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q34 = average_time
```

    Average response time 0.074 seconds
    



**Unique Artist with filtered features between 2020 and 2023**


```python
# MySQL
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MyCursor.execute('SELECT DISTINCT artist_name FROM artists a JOIN tracks t ON a.artist_id=t.artist_id JOIN track_features tf ON t.track_id=tf.track_id WHERE t.genre = "rock" AND t.release_year BETWEEN 2020 AND 2023 AND t.popularity>50 AND t.duration_ms<240000 AND tf.energy BETWEEN 0.20 AND 0.80 AND tf.valence > 0.6')
    myresult = MyCursor.fetchall()
    for x in myresult:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
MySQL_Q35 = average_time
```

    Average response time 0.006 seconds
    


```python
# MongoDB
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_songs = list(songs_collection.distinct('artist_name',{'genre':'rock','popularity': {'$gt':50 },'release_year': {'$gte':2020,'$lte':2023},'duration_ms':{'$lt':240000},'metrics.energy':{'$gte':0.20,'$lte':0.80},'metrics.valence':{'$gt':0.6}}))
    for x in MongoDB_songs:
        pass
    end = time.perf_counter()
    total_time += end - start
average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
LocalMongoDB_Q35 = average_time
```

    Average response time 0.004 seconds
    


```python
# MongoDB Cloud
total_time = 0
for i in range(20):
    start = time.perf_counter()
    MongoDB_Songs_Cloud = list(cloud_songs_collection.distinct('artist_name',{'genre':'rock','popularity': {'$gt':50 },'release_year': {'$gte':2020,'$lte':2023},'duration_ms':{'$lt':240000},'metrics.energy':{'$gte':0.20,'$lte':0.80},'metrics.valence':{'$gt':0.6}}))
    for x in MongoDB_Songs_Cloud:
        pass
    end = time.perf_counter()
    total_time += end - start

average_time = total_time / 20
print(f"Average response time {average_time:.3f} seconds")
Cloud_MongoDB_Q35 = average_time
```

    Average response time 0.074 seconds
